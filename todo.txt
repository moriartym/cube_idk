tidy all code and structure